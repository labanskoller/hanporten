{"config":{"lang":["sv"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"HAN-porten","text":"<p>Denna sida inneh\u00e5ller information om det nya lokala kundgr\u00e4nssnitt som ska finnas p\u00e5  nya elm\u00e4tare i Sverige. De nya elm\u00e4tarna installeras just nu runt om i landet och skall  vara helt utbytta tills 2025.</p> <p>Det lokala kundgr\u00e4nssnittet kallas bland annat HAN-porten (Home Area Network),  P1-porten eller H1-porten.</p> <p>P\u00e5 denna sidan samlas information om hur HAN-porten fungerar, information om protokollet samt exempelkod p\u00e5 hur man kan tolka data som m\u00e4taren skickar.</p>"},{"location":"#ditt-elnatsbolag-kan-aktivera-porten","title":"Ditt eln\u00e4tsbolag kan aktivera porten","text":"<p>HAN-porten \u00e4r som standard inaktiv och du beh\u00f6ver kontakta ditt eln\u00e4tsbolag f\u00f6r att de  skall aktivera den utan n\u00e5gon extra kostnad f\u00f6r dig. Flyttar du in i ett nytt hus/l\u00e4genhet kan du beh\u00f6va beg\u00e4ra den aktiverad igen \u00e4ven om  den f\u00f6rra \u00e4garen hade den aktiverad s\u00e5 den st\u00e4ngs av vid utflytt.</p>"},{"location":"#vilken-sorts-han-port-har-jag","title":"Vilken sorts HAN-port har jag?","text":"<p>Energif\u00f6retagen Sverige har tagit fram en branschrekommendation  f\u00f6r hur HAN-porten p\u00e5 svenska elm\u00e4tare b\u00f6r utformas. Men vissa n\u00e4tbolag rullade ut nya m\u00e4tare med HAN-port innan dessa rekommendationer var fullt p\u00e5 plats. D\u00e4rf\u00f6r finns det  \u00e4ven elm\u00e4tare med den norska varianten av HAN-port. Skillnaden \u00e4r att den norska \u00e4r  en RJ45 kontakt (vanlig internetsladd) och den svenska \u00e4r en RJ12 kontakt.</p>"},{"location":"#om-hanportense","title":"Om HANporten.se","text":"<p>hanporten.se drivs av Utilitarian,  experter inom energim\u00e4tning, m\u00e4tv\u00e4rdesinsamling och hantering av energidata.</p> <p>Denna sida hostas p\u00e5 Github. Om du har \u00f6nskem\u00e5l  om inneh\u00e5ll, tips eller ser n\u00e5got som \u00e4r fel f\u00e5r du g\u00e4rna \u00f6ppna  ett issue. Gillar ni sidan s\u00e5 f\u00e5r ni g\u00e4rna ge repot en stj\u00e4rna p\u00e5 Github.</p> <p>Inneh\u00e5llet p\u00e5 denna sida \u00e4r licensierat under CC BY-SA 4.0</p>"},{"location":"matare/","title":"M\u00e4tare","text":"<p>En samling av de m\u00e4tare som anv\u00e4nds i Sverige och vart HAN-porten sitter p\u00e5 dem.</p>"},{"location":"matare/#aidon-6534","title":"Aidon 6534","text":"<p>HAN-porten sitter p\u00e5 h\u00f6gra sidan \u00f6ver terminalluckan.</p>"},{"location":"matare/#iskra-am550","title":"Iskra AM550","text":"<p>HAN-porten \u00e4r m\u00e4rkt med P1 och sitter uppe i h\u00f6gra h\u00f6rnet p\u00e5 m\u00e4taren. E.ON kan ej aktivera HAN-porten p\u00e5 denna modell.</p>"},{"location":"matare/#kaifa-ma304","title":"Kaifa MA304","text":"<p>HAN-porten sitter under en gummilucka till v\u00e4nster p\u00e5 m\u00e4tarens framsida. Det finns b\u00e5de versioner med den svenska och norska standarden ute hos olika eln\u00e4tsbolag.</p>"},{"location":"matare/#landis-gyr-e360","title":"Landis &amp; Gyr E360","text":"<p>HAN-porten p\u00e5 Landis &amp; Gyr E360 sitter under luckan.</p>"},{"location":"matare/#sagemcom-s211","title":"Sagemcom S211","text":"<p>HAN-porten sitter under luckan i nedre v\u00e4nstra h\u00f6rnet.</p>"},{"location":"matare/#sagemcom-t211","title":"Sagemcom T211","text":"<p>HAN-porten sitter under luckan i nedre v\u00e4nstra h\u00f6rnet.</p>"},{"location":"matare/#sanxing-s34u18","title":"SanXing S34U18","text":"<p>HAN-porten sitter under den gr\u00e5 luckan nere till h\u00f6ger.</p>"},{"location":"natbolag/","title":"Eln\u00e4tsbolag","text":"<p>Information om hur man aktiverar HAN-porten hos olika eln\u00e4tsbolag. </p>"},{"location":"natbolag/#eon","title":"E.ON","text":"<p>Det \u00e4r m\u00f6jligt att aktivera porten via <code>Minas Sidor</code> eller via E.ONs app. Hittas under <code>Mina Avtal</code>.  I E.ONs n\u00e4t finns m\u00e4tarna:</p> <ul> <li>Landis &amp; Gyr E360</li> <li>Iskra AM550  (E.ON aktiverar inte HAN-porten p\u00e5 denna m\u00e4tartyp)</li> </ul>"},{"location":"natbolag/#ellevio","title":"Ellevio","text":"<p>Du kan aktivera HAN-porten p\u00e5 Mina Sidor  som privatperson eller p\u00e5 Energikontot  som f\u00f6retagskund.</p> <p>I Ellevios n\u00e4t finns m\u00e4tarna:</p> <ul> <li>Sagemcom S211</li> <li>Sagemcom T211</li> </ul>"},{"location":"natbolag/#eskilstuna-energi-och-miljo","title":"Eskilstuna Energi och Milj\u00f6","text":"<p>Man aktiverar porten genom att fylla i ett webbformul\u00e4r h\u00e4r: https://www.eem.se/privat/elnat/elmatare/han-porten/</p> <p>I Eskilstuna Energi och Milj\u00f6 eln\u00e4t finns m\u00e4tarna:</p> <ul> <li>Aidon 6534 </li> </ul>"},{"location":"natbolag/#malarenergi","title":"M\u00e4larenergi","text":"<p>I dagsl\u00e4get har M\u00e4larenergi ingen sj\u00e4lvbetj\u00e4ning f\u00f6r aktivering av HAN-porten. F\u00f6r att aktivera HAN-porten m\u00e5ste du ta kontakt med deras kundtj\u00e4nst</p> <p>I M\u00e4larenergis n\u00e4t finns m\u00e4tarna:</p> <ul> <li>Kaifa MA304 (Med norsk HAN-port)</li> </ul>"},{"location":"natbolag/#nacka-energi","title":"Nacka Energi","text":"<p>HAN-porten kan aktiveras genom att kontakta kundtj\u00e4nst.</p> <p>I Nacka Energis n\u00e4t finns m\u00e4tarna:</p> <ul> <li>Kaifa MA304 (Med svensk HAN-port)</li> </ul>"},{"location":"natbolag/#sevab-strangnas-energi","title":"SEVAB Str\u00e4ngn\u00e4s Energi","text":"<p>Man aktiverar porten genom att fylla i ett webbformul\u00e4r h\u00e4r: https://www.sevab.com/privat/elnat/elmatare/han-porten/</p> <p>I SEVABs eln\u00e4t finns m\u00e4tarna:</p> <ul> <li>Aidon 6534 </li> </ul>"},{"location":"natbolag/#skanska-energi","title":"Sk\u00e5nska Energi","text":"<p>Du beg\u00e4r aktivering av HAN-porten genom att maila kundtj\u00e4nst: https://www.skanska-energi.se/kontakta-oss/</p> <p>I Sk\u00e5nska Energis n\u00e4t finns m\u00e4tarna:</p> <ul> <li>Sagemcom T211</li> </ul>"},{"location":"natbolag/#tekniska-verken","title":"Tekniska Verken","text":"<p>Man aktiverar porten genom att best\u00e4lla det via Tekniska verkens kundsidor: https://www.tekniskaverken.se/mina-sidor/bestallaboka</p> <p>I Tekniska verkens n\u00e4t finns m\u00e4tarna:</p> <ul> <li>Aidon 6534</li> <li>Aidon 6511</li> <li>Aidon 6560</li> <li>Aidon 6550</li> </ul> <p>OBS: Kontrollera din m\u00e4tare</p> <p>Tekniska verken rullade ut m\u00e4tare tidigt och har en mix av norska (RJ45) och svenska (RJ12) standarden. Det finns ocks\u00e5 en version d\u00e4r det elektriska interfacet \u00e4r svenskt (RJ12) men datan som skickas \u00e4r enligt den norska standarden.</p>"},{"location":"natbolag/#vattenfall","title":"Vattenfall","text":"<p>HAN-porten aktiveras genom <code>Mina Sidor</code>.</p> <p>I Vattenfalls n\u00e4r finns m\u00e4tarna:</p> <ul> <li>SanXing S34U18</li> </ul>"},{"location":"norska/kretsschema/","title":"Kretsscheman","text":"<p>H\u00e4r samlar vi information om kretsar f\u00f6r att f\u00e5 ut signalen korrekt fr\u00e5n den norska HAN-porten.</p> <p>M\u00e4taren agerar Mbus master som pushar data. F\u00f6r att l\u00e4sa av informatinen beh\u00f6vs en  krets f\u00f6r Mbus slav.</p> <p>Ej testat av Utilitarian</p> <p>Vi har inte testat av n\u00e5gon av dessa m\u00f6jliga l\u00f6sningar.</p> <ul> <li>USB adapter</li> <li>Mbus transceiver</li> </ul>"},{"location":"norska/l%C3%B6sningar/","title":"L\u00f6sningar","text":"<p>H\u00e4r samlar vi l\u00e4nkar till olika l\u00f6sningar som finns att k\u00f6pa eller bygga sj\u00e4lv f\u00f6r utl\u00e4sning av den norska HAN-porten. </p> <p>Om du har en l\u00e4nk du vill f\u00e5 med p\u00e5 denna sidan, forka repot p\u00e5 Github, g\u00f6r en ny  branch p\u00e5 din fork d\u00e4r du l\u00e4gger till l\u00e4nken och \u00f6ppna sedan ett pull-requeset f\u00f6r att  merga in dina \u00e4ndringar till sidan.</p> <p>OBS!</p> <p>Vi validerar inte att n\u00e5gra av dessa l\u00f6sningarna faktiskt fungerar utan har listan som en hj\u00e4lp till de som letar efter en l\u00f6sning.</p>"},{"location":"norska/l%C3%B6sningar/#kop","title":"K\u00f6p","text":"<ul> <li>https://amsleser.no/ - F\u00e4rdiga moduler eller byggkit f\u00f6r HAN-porten </li> </ul>"},{"location":"norska/l%C3%B6sningar/#bygg-sjalv","title":"Bygg sj\u00e4lv","text":"<ul> <li>https://amsleser.no/ - F\u00e4rdiga moduler eller byggkit f\u00f6r HAN-porten </li> </ul>"},{"location":"norska/porten/","title":"Norska porten","text":"<p>HAN-porten, eller P1-porten, sitter oftast under ett litet lock p\u00e5 din elm\u00e4tare. </p> <p>Den norska varianten best\u00e5r av ett RJ45 uttag, samma som p\u00e5 vanliga internetsladdar.</p>"},{"location":"norska/porten/#spanningsmatning-av-utrustning","title":"Sp\u00e4nningsmatning av utrustning","text":"<p>Eftersom det elektriska interfacet \u00e4r MBus \u00e4r det m\u00f6jligt att sp\u00e4nningsmata din  utrustning genom porten. Men det kr\u00e4vs en ordentligt Mbus slave implementation p\u00e5  h\u00e5rdvarusidan. </p>"},{"location":"norska/porten/#pin-layout","title":"PIN-layout","text":"Pin Namn Beskrivning Kommentar 1 MBus + MBus tr\u00e5dpar 2 Mbus - MBus tr\u00e5dpar startar export av data"},{"location":"norska/porten/#koppla-in-extra-utrustning","title":"Koppla in extra utrustning","text":"<p>MBus i m\u00e4taren agerar master och det \u00e4r m\u00f6jligt att ha flera slavar p\u00e5 slingan som  lyssnar pushad data. </p>"},{"location":"norska/protokollet/","title":"Protokollet","text":"<p>Protokollet som skickas p\u00e5 den norska HAN-porten \u00e4r en DLMS/COSEM DataNotification APDU i en  HDLC unnumbered information frame</p> <p>Ej verifierat</p> <p>Vi har ingen m\u00e4tare med denna typ av port och har inte verifierat om allt \u00e4r helt korrekt. Men om n\u00e5gon har en m\u00e4tare med denna port f\u00e5r de g\u00e4rna verifiera och meddela oss.</p>"},{"location":"norska/protokollet/#datainnehall","title":"Datainneh\u00e5ll","text":"<p>Datan \u00e4r ett antal rader som liknar datan i den svenska standarden, men formaterad  mer enligt DLMS. Den inneh\u00e5ller en rad f\u00f6r tid och datum, en rad f\u00f6r identifiering av m\u00e4taren och flera rader som inneh\u00e5ller OBIS, v\u00e4rde, skal\u00e4r och enhet.</p>"},{"location":"norska/protokollet/#seriellt-granssnitt","title":"Seriellt gr\u00e4nssnitt","text":"<p>Data skickas med 2400 baud och i byteformat <code>8E1</code></p>"},{"location":"norska/protokollet/#exempeldata","title":"Exempeldata","text":"<pre><code>7e a10b 41 0883 13 fa7c e6e700\n     0f 40000000 00\n     010c\n         0202 0906 0101000281ff 0a0b 4149444f4e5f5630303031\n         0202 0906 0000600100ff 0a10 3733XXXXXXXXXXXXXXXXXXXXXXX13130\n         0202 0906 0000600107ff 0a04 36353235\n         0203 0906 0100010700ff 06 00000e90 0202 0f00 161b\n         0203 0906 0100020700ff 06 00000000 0202 0f00 161b\n         0203 0906 0100030700ff 06 0000001c 0202 0f00 161d\n         0203 0906 0100040700ff 06 00000000 0202 0f00 161d\n         0203 0906 01001f0700ff 10 0091     0202 0fff 1621\n         0203 0906 0100470700ff 10 0090     0202 0fff 1621\n         0203 0906 0100200700ff 12 0932     0202 0fff 1623\n         0203 0906 0100340700ff 12 091e     0202 0fff 1623\n         0203 0906 0100480700ff 12 0933     0202 0fff 1623\n 95d4 7e\n</code></pre>"},{"location":"norska/protokollet/#las-ut-datan","title":"L\u00e4s ut datan","text":"<p>HDLC frames \u00e4r inramade av ascii tilde <code>~</code>/<code>0x7e</code>. </p> <p>Ett enkelt program som l\u00e4ser av ett seriellt gr\u00e4nssnitt kan l\u00e4sa tills det hittar en  frame-end och testa att parsa inl\u00e4st data som en hdlc-frame. Om det inte g\u00e5r att parsa  forts\u00e4tter man l\u00e4sa tills n\u00e4sta frame-end.</p>"},{"location":"norska/protokollet/#parsa-data","title":"Parsa data","text":"<pre><code>from dlms_cosem.protocol import xdlms\nfrom dlms_cosem.hdlc import frames\nfrom dlms_cosem.utils import parse_as_dlms_data\nfrom dlms_cosem.cosem import Obis\nfrom dlms_cosem.time import datetime_from_bytes\n\n# 3-phase\nhdlc_data_hex = (\n    \"7ea2434108831385ebe6e7000f4000000000011b020209060000010000ff090c07e30c1001073b28ff\"\n    \"8000ff020309060100010700ff060000046202020f00161b020309060100020700ff06000000000202\"\n    \"0f00161b020309060100030700ff06000005e302020f00161d020309060100040700ff060000000002\"\n    \"020f00161d0203090601001f0700ff10000002020fff1621020309060100330700ff10004b02020fff\"\n    \"1621020309060100470700ff10000002020fff1621020309060100200700ff12090302020fff162302\"\n    \"0309060100340700ff1209c302020fff1623020309060100480700ff12090402020fff162302030906\"\n    \"0100150700ff060000000002020f00161b020309060100160700ff060000000002020f00161b020309\"\n    \"060100170700ff060000000002020f00161d020309060100180700ff060000000002020f00161d0203\"\n    \"09060100290700ff060000046202020f00161b0203090601002a0700ff060000000002020f00161b02\"\n    \"03090601002b0700ff06000005e202020f00161d0203090601002c0700ff060000000002020f00161d\"\n    \"0203090601003d0700ff060000000002020f00161b0203090601003e0700ff060000000002020f0016\"\n    \"1b0203090601003f0700ff060000000002020f00161d020309060100400700ff060000000002020f00\"\n    \"161d020309060100010800ff060099598602020f00161e020309060100020800ff060000000802020f\"\n    \"00161e020309060100030800ff060064ed4b02020f001620020309060100040800ff06000000050202\"\n    \"0f001620be407e\"\n)\n\nui = frames.UnnumberedInformationFrame.from_bytes(bytes.fromhex(hdlc_data_hex))\ndn = xdlms.DataNotification.from_bytes(\n    ui.payload[3:]\n)  # The first 3 bytes should be ignored.\nresult = parse_as_dlms_data(dn.body)\n\n# First is date\ndate_row = result.pop(0)\nclock_obis = Obis.from_bytes(date_row[0])\nclock, stats = datetime_from_bytes(date_row[1])\nprint(f\"Clock object: {clock_obis.to_string()}, datetime={clock}\")\n\n# rest is data\nfor item in result:\n    obis = Obis.from_bytes(item[0])\n    value = item[1]\n    print(f\"{obis.to_string()}={value}\")\n</code></pre>"},{"location":"norska/protokollet/#timing","title":"Timing","text":"<p>Det verkar vara lite olika med vilken data som skickas och hur ofta.</p>"},{"location":"svenska/avvikelser/","title":"Avvikande implementationer","text":"<p>En lista p\u00e5 de olika, fr\u00e5n branschrekommendationer, avvikande implementationer som har  \u00e5terfunnits i Sverige p\u00e5 en RJ12 port.</p>"},{"location":"svenska/avvikelser/#hdlc-dlms-push","title":"HDLC + DLMS Push.","text":"<p>Todo</p> <p>Beskriv den data som anv\u00e4nds av Tekniska verken.</p>"},{"location":"svenska/avvikelser/#standard-iec62056-21","title":"Standard IEC62056-21","text":"<p>Todo</p> <p>Vissa m\u00e4tare anv\u00e4nder standard IEC62056-21 utan \u00e4ndringarna i DSMR P1 Companion standard.</p>"},{"location":"svenska/kretsschema/","title":"Kretsscheman","text":"<p>H\u00e4r samlar vi information om kretsar f\u00f6r att f\u00e5 ut signalen korrekt fr\u00e5n HAN-porten.</p> <p>F\u00f6r att koppla in datasignalen enkelt i, till exempel, en Arduino eller Raspberry Pi beh\u00f6ves signalen inverteras. </p> <p>Nedan \u00e4r en enkel inverter-krets baserat p\u00e5 en PNP-transistor</p> <p></p> <p>OBS!</p> <p>Denna krets \u00e4r inget vi rekommenderar i en produkt, men duger bra om man vill  koppla upp n\u00e5got snabbt. Vi p\u00e5 Utilitarian \u00e4r inga h\u00e5rdvaruexperter och kan inte ge rekommendationer p\u00e5  h\u00e5rdvarudesign f\u00f6r en produktionsf\u00e4rdig l\u00f6sning. Men vi kan hj\u00e4lpa till med  protokollimplementationen om det beh\u00f6vs.</p> <p>Om det finns n\u00e5gon med b\u00e4ttre h\u00e5rdvarukunskaper \u00e4n oss som vill dela med sig av en  b\u00e4ttre design l\u00e4gger vi g\u00e4rna upp det p\u00e5 denna sidan. Helst under en Open Hardware  licens. </p>"},{"location":"svenska/l%C3%B6sningar/","title":"L\u00f6sningar","text":"<p>H\u00e4r samlar vi l\u00e4nkar till olika l\u00f6sningar som finns att k\u00f6pa eller bygga sj\u00e4lv f\u00f6r utl\u00e4sning av den svenska HAN-porten. </p> <p>Om du har en l\u00e4nk du vill f\u00e5 med p\u00e5 denna sidan, forka repot p\u00e5 Github, g\u00f6r en ny  branch p\u00e5 din fork d\u00e4r du l\u00e4gger till l\u00e4nken och \u00f6ppna sedan ett pull-requeset f\u00f6r att  merga in dina \u00e4ndringar till sidan.</p> <p>OBS!</p> <p>Vi validerar inte att n\u00e5gra av dessa l\u00f6sningarna faktiskt fungerar utan har listan som en hj\u00e4lp till de som letar efter en l\u00f6sning.</p>"},{"location":"svenska/l%C3%B6sningar/#kop","title":"K\u00f6p","text":"<ul> <li>PiiGAB HAN-P1 Converter, omvandlar HAN-P1 till M-Bus</li> <li>https://amsleser.no/ - F\u00e4rdiga moduler eller byggkit f\u00f6r HAN-porten </li> <li>https://www.homewizard.com/p1-meter/ - Dongel f\u00f6r P1 porten</li> </ul>"},{"location":"svenska/l%C3%B6sningar/#bygg-sjalv","title":"Bygg sj\u00e4lv","text":"<ul> <li>https://amsleser.no/ - F\u00e4rdiga moduler eller byggkit f\u00f6r HAN-porten </li> <li>https://github.com/HenrikSolver/picowhanport - HAN -&gt; MQTT med Raspberry pi pico w</li> </ul>"},{"location":"svenska/porten/","title":"Svenska porten","text":"<p>HAN-porten, eller P1-porten, sitter oftast under ett litet lock p\u00e5 din elm\u00e4tare. Den  best\u00e5r av ett RJ12 uttag. Den svenska porten \u00e4r baserad p\u00e5 DSMR P1 Companion Standard</p>"},{"location":"svenska/porten/#spanningsmatning-av-utrustning","title":"Sp\u00e4nningsmatning av utrustning","text":"<p>Det \u00e4r m\u00f6jligt att sp\u00e4nningsmata din utrustning direkt fr\u00e5n HAN-porten. Den levererar  +5 V p\u00e5 en pinne som kan anv\u00e4ndas f\u00f6r att driva extern utrustning. Du kan dra max  250 mA fr\u00e5n porten.</p> <p>H\u00f6r med ditt n\u00e4tbolag</p> <p>Enligt rekommendationerna \u00e4r det inte ett krav att leverera en HAN-port med  sp\u00e4nningsmatning fr\u00e5n m\u00e4tarna. S\u00e5 det \u00e4r m\u00f6jligt att den m\u00e4tare ditt elbolag k\u00f6pt  in inte kan sp\u00e4nningsmata utrustningen. Men de st\u00f6rsta bolagen levererar port med  sp\u00e4nningsmatning. </p>"},{"location":"svenska/porten/#pin-layout","title":"PIN-layout","text":"Pin Namn Beskrivning Kommentar 1 VCC +5V sp\u00e4nningsmatning Kan anv\u00e4ndas f\u00f6r att driva utrustning 2 DATA REQUEST +5V p\u00e5 denna startar export av data Om man alltid vill att utrustningen skall skicka data s\u00e5 bygla \u00f6ver +5V till denna 3 DATA GND Jord data 4 NC Inte ansluten Anv\u00e4nds inte 5 DATA OUT Data output \u00d6ppen kollektor 6 GND Jord sp\u00e4nningsmatning"},{"location":"svenska/porten/#koppla-in-extra-utrustning","title":"Koppla in extra utrustning","text":"<p>Om du beh\u00f6ver mer \u00e4n en enhet kan du anv\u00e4nda en hub som delar datasignalen till flera  HAN-portar. Men detta kan kr\u00e4va att man m\u00e5ste sp\u00e4nningsmata utrustningen separat d\u00e5 det  inte \u00e4r s\u00e4kert att HAN-porten kan driva flera enheter.</p>"},{"location":"svenska/protokollet/","title":"Protokollet","text":"<p>Protokollet baseras p\u00e5 IEC62056-21 Mode D. Men n\u00e5gra skillnader som anges nedan. Om du vill f\u00f6rdjupa dig i IEC62056-21 s\u00e5 kan du kolla in v\u00e5rt  open source bibliotek f\u00f6r  protokollet.</p>"},{"location":"svenska/protokollet/#seriellt-granssnitt","title":"Seriellt gr\u00e4nssnitt","text":"<p>Man l\u00e4ser av data via ett seriellt gr\u00e4nssnitt. Till skillnad p\u00e5 IEC62056-21 s\u00e5 skall teckenformatet vara <code>8N1</code> (8 databits, ingen paritet, en stop bit). Standard IEC62056-21 \u00e4r 7E1</p> <p>\u00d6verf\u00f6ringshastigheten \u00e4r satt fast till <code>115200 baud</code></p> <p>Kodexempel f\u00f6r seriell port</p> Python <pre><code>import serial\n\nserial_port = serial.Serial(\n    \"/dev/ttyUSB0\",  # your serial port name\n    baudrate=115200,\n    parity=serial.PARITY_NONE,\n    stopbits=serial.STOPBITS_ONE,\n    bytesize=serial.EIGHTBITS,\n    timeout=30\n    rtscts=False,\n    dsrdtr=False,\n    xonxoff=False,\n)\nserial_port.open()\n\n...\n\n# do something\n\n...\n\nserial_port.close()\n</code></pre> Node.js <pre><code>const SerialPort = require('serialport')\n\nconst options = {baudRate: 115200, dataBits: 8, stopBits: 1, parity: none}\ncost serialPort = new SerialPort(\"/dev/ttyUSB0\", options)\nserialPort.open()\n...\n// do something\n...\nserialPort.close()\n</code></pre>"},{"location":"svenska/protokollet/#timing","title":"Timing","text":"<p>N\u00e4r HAN-porten f\u00e5r +5V p\u00e5 <code>DATA REQUEST</code> b\u00f6rjar den skicka data p\u00e5 <code>DATA OUT</code>.</p> <p>Data skickas var 10:e sekund.</p> <p>Porten \u00e4r enkelriktad s\u00e5 det \u00e4r inte m\u00f6jligt att skicka n\u00e5gon data till m\u00e4taren,  vilket g\u00f6r det enkelt endast lyssna efter data.</p>"},{"location":"svenska/protokollet/#meddelandestruktur","title":"Meddelandestruktur","text":"<p>Den generella meddelandestrukturen f\u00f6r ett meddelande p\u00e5 HAN-porten \u00e4r:</p> <p><code>/ XXXZ Ident CR LF CR LF Data ! CRC CR LF</code></p> <p>Varje del av meddelandet \u00e4r separerat med <code>CR LF</code> dvs line-breaks. S\u00e5 n\u00e4r man g\u00f6r ett  program \u00e4r det smidigt att anv\u00e4nda en <code>readline</code> funktion som finns i de flesta  programspr\u00e5k.</p> <ol> <li> <p>F\u00f6rsta raden: <code>/ XXXZ Ident CR LF</code> inneh\u00e5ller information som identifierar m\u00e4taren.     De f\u00f6rsta 3 bokst\u00e4verna \u00e4r ett FLAG ID     som visar vilken tillverkar det \u00e4r. Z visar p\u00e5 vilken baudrate, men den beh\u00f6ver inte     st\u00e4mma eftersom HAN-porten k\u00f6r p\u00e5 en fast baudrate. Ident \u00e4r det unika ID:t p\u00e5 m\u00e4taren.</p> </li> <li> <p>Sedan kommer en tom rad som visar att datan b\u00f6rjar.</p> </li> <li> <p>Ett flertal datarader. Se mer under Datarader</p> </li> <li> <p>Sista raden som b\u00f6rjar med <code>!</code> som visar att data delen \u00e4r slut och sedan 2 bytes CRC f\u00f6r meddelandet.    CRC:n (Cyclic Redundancy Check) anv\u00e4nds f\u00f6r att verifiera att man mottagit meddelandet p\u00e5 ett korrekt s\u00e4tt.    Alla bytes fr\u00e5n <code>/</code> till <code>!</code>  skall anv\u00e4ndas i ber\u00e4kningen f\u00f6r CRC.</p> </li> </ol> <p>CRC ber\u00e4kning</p> <pre><code>import libscrc\n\nexample_data = (\n    b\"/ELL5\\x5c253833635_A\\r\\n\\r\\n\"\n    b\"0-0:1.0.0(210217184019W)\\r\\n\"\n    b\"1-0:1.8.0(00006678.394*kWh)\\r\\n\"\n    b\"1-0:2.8.0(00000000.000*kWh)\\r\\n\"\n    b\"1-0:3.8.0(00000021.988*kvarh)\\r\\n\"\n    b\"1-0:4.8.0(00001020.971*kvarh)\\r\\n\"\n    b\"1-0:1.7.0(0001.727*kW)\\r\\n\"\n    b\"1-0:2.7.0(0000.000*kW)\\r\\n\"\n    b\"1-0:3.7.0(0000.000*kvar)\\r\\n\"\n    b\"1-0:4.7.0(0000.309*kvar)\\r\\n\"\n    b\"1-0:21.7.0(0001.023*kW)\\r\\n\"\n    b\"1-0:41.7.0(0000.350*kW)\\r\\n\"\n    b\"1-0:61.7.0(0000.353*kW)\\r\\n\"\n    b\"1-0:22.7.0(0000.000*kW)\\r\\n\"\n    b\"1-0:42.7.0(0000.000*kW)\\r\\n\"\n    b\"1-0:62.7.0(0000.000*kW)\\r\\n\"\n    b\"1-0:23.7.0(0000.000*kvar)\\r\\n\"\n    b\"1-0:43.7.0(0000.000*kvar)\\r\\n\"\n    b\"1-0:63.7.0(0000.000*kvar)\\r\\n\"\n    b\"1-0:24.7.0(0000.009*kvar)\\r\\n\"\n    b\"1-0:44.7.0(0000.161*kvar)\\r\\n\"\n    b\"1-0:64.7.0(0000.138*kvar)\\r\\n\"\n    b\"1-0:32.7.0(240.3*V)\\r\\n\"\n    b\"1-0:52.7.0(240.1*V)\\r\\n\"\n    b\"1-0:72.7.0(241.3*V)\\r\\n\"\n    b\"1-0:31.7.0(004.2*A)\\r\\n\"\n    b\"1-0:51.7.0(001.6*A)\\r\\n\"\n    b\"1-0:71.7.0(001.7*A)\\r\\n!\"\n)\ncrc16 = libscrc.ibm(example_data).to_bytes(2, 'big').hex()\n&gt;&gt; '7945'\n</code></pre>"},{"location":"svenska/protokollet/#datarader","title":"Datarader","text":"<p>En datarad har formatet:</p> <p><code>OBIS ( V\u00e4rde * Enhet ) CR LF</code></p>"},{"location":"svenska/protokollet/#obis","title":"OBIS","text":"<p>OBIS (OBject Identifier System) \u00e4r en del av DLMS/COSEM och visar vilket v\u00e4rde dataraden g\u00e4ller.</p> <p>Formatet \u00e4r <code>A-B:C.D.E.F</code>       (ex: 1-0:1.8.0.255)</p> <p>Varje del kan vara mellan 0-255. Del <code>F</code> \u00e4r n\u00e4stan alltid 255 (anv\u00e4nds ej) och i den  svenska branchstandarden skickas det inte med.</p> V\u00e4rdegrupp Beskrivning A Med\u00edum, Ex: Elektricitet B Kanal C M\u00e4tv\u00e4rde, Ex: Effekt Fas 1 D M\u00e4tv\u00e4rdeshantering, Ex: Momentan, Kumulativ. E Tariff, Ex: dag/natt F Faktureringsperiod eller historisk data. <p>Exempel OBIS</p> <p>1-0:1.8.0.255 -&gt; El, Aktiv effekt f\u00f6rbrukning p\u00e5 alla faser, tidsintegral 1 (energi)</p> <p>S\u00e5 det anger hur mycket energi som konsumerats genom m\u00e4taren. (M\u00e4tarst\u00e4llning)</p>"},{"location":"svenska/protokollet/#varde-och-enhet","title":"V\u00e4rde och enhet","text":"<p>V\u00e4rde och enhet \u00e4r avdelat med <code>*</code>. Vissa v\u00e4rden har ingen enhet (till exempel tid och datum) och d\u00e5 finns d\u00e4r inget * inom parenteserna.</p>"},{"location":"svenska/protokollet/#svenska-branschrekommendationer","title":"Svenska branschrekommendationer","text":"<p>Energif\u00f6retagen har tagit fram en  branschrekommendation  om hur HAN-porten borde fungera och vilken data som b\u00f6r publiceras p\u00e5 HAN-porten.</p> <p>Lite f\u00f6rtydlingar</p> <p>Med uttag menas uttag fr\u00e5n eln\u00e4tet. Det vill s\u00e4ga det du f\u00f6rbrukar. Med inmating    menas det du matar in i eln\u00e4tet (till exampel om du har solceller)</p> <p>Den sista delen i OBIS har tagits bort d\u00e5 den inte tillf\u00f6r n\u00e5gon information.</p> <p>Tiden som visas \u00e4r i svensk normaltid (UTC+1). Elm\u00e4tare i Sverige \u00e4ndrar inte om    f\u00f6r sommartid. X anger om det \u00e4r sommartid eller ej och kan ignoreras.</p> OBIS Beskrivning Kommentar Exempel-v\u00e4rde 0-0.1.0.0 Datum och tid Formatet <code>YYMMDDhhmmssX</code> 210217184019W 1-0:1.8.0 M\u00e4tarst\u00e4llning Aktiv Energi Uttag 00006678.394*kWh 1-0:2.8.0 M\u00e4tarst\u00e4llning Aktiv Energi Inmatning 00000000.000*kWh 1-0:3.8.0 M\u00e4tarst\u00e4llning Reaktiv Energi Uttag 00000021.988*kvarh 1-0:4.8.0 M\u00e4tarst\u00e4llning Reaktiv Energi Inmatning 00001020.971*kvarh 1-0:1.7.0 Aktiv Effekt Uttag Momentan trefaseffekt 0001.727*kW 1-0:2.7.0 Aktiv Effekt Inmatning Momentan trefaseffekt 0000.000*kW 1-0:3.7.0 Reaktiv Effekt Uttag Momentan trefaseffekt 0000.000*kvar 1-0:4.7.0 Reaktiv Effekt Inmatning Momentan trefaseffekt 0000.309*kvar 1-0:21.7.0 L1 Aktiv Effekt Uttag Momentan effekt 0001.023*kW 1-0:22.7.0 L1 Aktiv Effekt Inmatning Momentan effekt 0000.350*kW 1-0:41.7.0 L2 Aktiv Effekt Uttag Momentan effekt 0000.353*kW 1-0:42.7.0 L2 Aktiv Effekt Inmatning Momentan effekt 0000.000*kW 1-0:61.7.0 L3 Aktiv Effekt Uttag Momentan effekt 0000.000*kW 1-0:62.7.0 L3 Aktiv Effekt Inmatning Momentan effekt 0000.000*kW 1-0:23.7.0 L1 Reaktiv Effekt Uttag Momentan effekt 0000.000*kvar 1-0:24.7.0 L1 Reaktiv Effekt Inmatning Momentan effekt 0000.000*kvar 1-0:43.7.0 L2 Reaktiv Effekt Uttag Momentan effekt 0000.000*kvar 1-0:44.7.0 L2 Reaktiv Effekt Inmatning Momentan effekt 0000.009*kvar 1-0:63.7.0 L3 Reaktiv Effekt Uttag Momentan effekt 0000.161*kvar 1-0:64.7.0 L3 Reaktiv Effekt Inmatning Momentan effekt 0000.138*kvar 1-0:32.7.0 L1 Fassp\u00e4nning Momentant RMS-v\u00e4rde 240.3*V 1-0:52.7.0 L2 Fassp\u00e4nning Momentant RMS-v\u00e4rde 240.1*V 1-0:72.7.0 L3 Fassp\u00e4nning Momentant RMS-v\u00e4rde 241.3*V 1-0:31.7.0 L1 Fasstr\u00f6m Momentant RMS-v\u00e4rde 004.2*A 1-0:51.7.0 L2 Fasstr\u00f6m Momentant RMS-v\u00e4rde 001.6*A 1-0:71.7.0 L3 Fasstr\u00f6m Momentant RMS-v\u00e4rde 001.7*A"},{"location":"svenska/%C3%B6vriga-resurser/","title":"\u00d6vriga Resurser","text":"<p>Har du en k\u00e4lla du skulle vilja se h\u00e4r ber vi er \u00f6ppna ett Pull-Request p\u00e5 Github. Om  du inte kan, s\u00e5 \u00f6ppna ett issue ist\u00e4llet s\u00e5 f\u00f6rs\u00f6ker vi hj\u00e4lpa dig.</p>"},{"location":"svenska/%C3%B6vriga-resurser/#kod-for-utlasning","title":"Kod f\u00f6r utl\u00e4sning","text":"<ul> <li>Example code for reading Skellefte\u00e5 Kraft Aidon energy meters with RJ45</li> </ul>"}]}